<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–µ—Å–Ω–∏</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .admin-wrap{ max-width: 1150px; margin: 0 auto; padding: 18px 16px 40px; }
    .admin-title{ font-family: 'Pacifico', cursive; font-size: 26px; margin: 0 0 6px 0; }
    .admin-sub{ color: var(--muted); margin: 0 0 16px 0; }
    .admin-grid{ display:grid; grid-template-columns: 1fr 1fr; gap: 12px; align-items:start; }
    .admin-card{ background: #fff; border: 1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow); padding: 14px; }
    .admin-card h3{ margin: 0 0 10px 0; font-size: 16px; }
    .admin-field{ display:flex; flex-direction:column; gap: 6px; margin-bottom: 10px; }
    .admin-field label{ font-weight: 800; }
    .admin-field input, .admin-field textarea, .admin-field select{
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 10px 12px;
      font-size: 14px;
      font-family: inherit;
    }
    .admin-field textarea{ min-height: 110px; resize: vertical; }
    .admin-row{ display:flex; gap: 10px; flex-wrap:wrap; }
    .admin-chipset{ display:flex; flex-wrap:wrap; gap: 8px 10px; }
    .admin-chipset label{
      display:flex; align-items:center; gap: 8px;
      border: 1px solid var(--border);
      border-radius: 999px;
      padding: 8px 10px;
      background: #fff;
      cursor: pointer;
      user-select:none;
    }
    .admin-actions{ display:flex; gap: 10px; flex-wrap: wrap; margin-top: 10px; }
    .admin-actions button{
      border:none; border-radius: 12px; padding: 12px 12px;
      cursor:pointer; font-weight: 800;
    }
    .btn-primary{ background: var(--accent); color: #fff; }
    .btn-dark{ background: #111827; color: #fff; }
    .btn-light{ background: #fff; border: 1px solid var(--border); }
    .codebox{
      width: 100%;
      min-height: 310px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 12px;
      line-height: 1.35;
      background: #0b1220;
      color: #e5e7eb;
      border: 1px solid rgba(255,255,255,0.10);
      border-radius: 14px;
      padding: 12px;
      white-space: pre;
      overflow:auto;
    }
    .hint{ color: var(--muted); font-size: 12px; margin-top: 6px; }
    
    .admin-nav{ display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap; margin: 0 0 10px 0; }
    .admin-nav-left{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
    .admin-link{
      display:inline-flex; align-items:center; gap:8px;
      border:1px solid var(--border);
      background:#fff;
      border-radius:12px;
      padding:10px 12px;
      font-weight:800;
      color: inherit;
      text-decoration:none;
      cursor:pointer;
    }
    .admin-link:hover{ box-shadow: var(--shadow); }

    .pill{ display:inline-flex; align-items:center; justify-content:center; border-radius: 999px; padding: 3px 8px; font-size: 12px; border: 1px solid var(--border); color: var(--muted); }

    .req-star{ color:#ef4444; margin-left:4px; font-weight:900; }
    .invalid{
      border-color:#ef4444 !important;
      box-shadow: 0 0 0 4px rgba(239,68,68,.12) !important;
      background:#fff !important;
    }
    .admin-errors{
      display:none;
      margin-top:10px;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid #fecaca;
      background:#fff1f2;
      color:#7f1d1d;
      font-size:13px;
      line-height:1.35;
    }


    .tasks-toolbar{ display:flex; align-items:center; justify-content:space-between; gap: 10px; flex-wrap:wrap; margin: 10px 0; }
    .task-editor{
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 12px;
      background: linear-gradient(180deg, #ffffff, #fbfcff);
      margin-bottom: 10px;
    }
    .task-top{ display:flex; align-items:flex-start; justify-content:space-between; gap: 10px; }
    .task-top h4{ margin:0; font-size: 14px; }
    .task-remove{
      border: 1px solid var(--border);
      background: #fff;
      border-radius: 12px;
      padding: 8px 10px;
      cursor:pointer;
      font-weight: 800;
    }
    .task-grid{ display:grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; }
    .task-grid .admin-field textarea{ min-height: 90px; }
    .task-grid .admin-field input, .task-grid .admin-field select, .task-grid .admin-field textarea{ font-size: 13px; }

    /* YouTube preview */
    .yt-preview{
      border: 1px solid var(--border);
      border-radius: 14px;
      overflow: hidden;
      background: #0b1220;
    }
    .yt-preview iframe{
      width: 100%;
      height: 220px;
      border: 0;
      display:block;
    }
    .yt-meta{
      display:flex;
      gap: 10px;
      align-items:center;
      margin-top: 10px;
      flex-wrap: wrap;
    }
    .yt-cover{
      width: 92px;
      height: 52px;
      border-radius: 10px;
      object-fit: cover;
      border: 1px solid rgba(255,255,255,0.10);
      background: #111827;
    }
    .yt-links a{
      display:inline-block;
      margin-right: 10px;
      font-weight: 800;
      text-decoration: none;
      color: var(--accent);
    }

    /* Set list */
    #setList{ display:grid; gap: 10px; margin-top: 10px; }
    .set-item{
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 12px;
      background: #fff;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 10px;
    }
    .set-item h4{ margin:0; font-size: 14px; }
    .set-item p{ margin: 4px 0 0 0; color: var(--muted); font-size: 12px; }
    .set-item .set-actions{ display:flex; gap: 8px; flex-wrap:wrap; justify-content:flex-end; }
    .set-item button{
      border: 1px solid var(--border);
      background: #fff;
      border-radius: 12px;
      padding: 8px 10px;
      cursor:pointer;
      font-weight: 800;
    }

    @media (max-width: 980px){
      .admin-grid{ grid-template-columns: 1fr; }
      .task-grid{ grid-template-columns: 1fr; }
      .yt-preview iframe{ height: 200px; }
    }
  </style>
</head>
<body>
  <div class="admin-wrap">
<div class="admin-nav">
      <div class="admin-nav-left">
        <a class="admin-link" href="./index.html">‚Üê <span data-i18n="openCatalog">–û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ç–∞–ª–æ–≥</span></a>
        <button class="admin-link" id="btnNewSong" type="button">Ôºã <span data-i18n="newSong">–ù–æ–≤–∞—è –ø–µ—Å–Ω—è</span></button>
      </div>
      <a class="admin-link" href="./admin.html">üõ† <span data-i18n="adminTitleShort">–ê–¥–º–∏–Ω–∫–∞</span></a>
    </div>

    <h1 class="admin-title">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–µ—Å–Ω–∏ (—Ñ–æ—Ä–º–∞ + –ø—Ä–µ–≤—å—é + –æ–±—â–∏–π –Ω–∞–±–æ—Ä)</h1>
    <p class="admin-sub">–ó–∞–ø–æ–ª–Ω–∏ –ø–µ—Å–Ω—é –∏ –∑–∞–¥–∞–Ω–∏—è ‚Üí –¥–æ–±–∞–≤—å –≤ –æ–±—â–∏–π –Ω–∞–±–æ—Ä ‚Üí —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π –≤ songs-data.js –∏–ª–∏ –≤ CSV.</p>

    <div class="admin-grid">
      <div class="admin-card">
        <h3>–û—Å–Ω–æ–≤–Ω–æ–µ</h3>

        <div class="admin-row">
          <div class="admin-field" style="flex:1; min-width:160px;">
            <label for="id">ID</label>
            <input id="id" type="number" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä 11" />
            <div class="hint">–ú–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º ‚Äî –ø–æ—Å—Ç–∞–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</div>
          </div>

          <div class="admin-field" style="flex:1; min-width:260px;">
            <label for="youtubeInput">YouTube —Å—Å—ã–ª–∫–∞ –∏–ª–∏ ID<span class="req-star">*</span></label>
            <input id="youtubeInput" type="text" placeholder="https://www.youtube.com/watch?v=kJQP7kiw5Fk" />
            <div class="hint">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±—ã—á–Ω—ã–µ —Å—Å—ã–ª–∫–∏, youtu.be –∏ shorts.</div>
          </div>
        </div>

        <div class="admin-field">
          <div class="yt-preview" id="ytPreview" style="display:none;">
            <iframe id="ytFrame" src="" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
          </div>

          <div class="yt-meta" id="ytMeta" style="display:none;">
            <img id="ytCover" class="yt-cover" alt="cover" src="" />
            <div class="yt-links">
              <a id="ytOpen" href="#" target="_blank" rel="noopener">–û—Ç–∫—Ä—ã—Ç—å YouTube</a>
              <a id="ytImg" href="#" target="_blank" rel="noopener">–û—Ç–∫—Ä—ã—Ç—å –æ–±–ª–æ–∂–∫—É</a>
              <span class="pill" id="ytIdPill"></span>
            </div>
          </div>
        </div>

        <div class="admin-row">
          <div class="admin-field" style="flex:1;">
            <label for="titleRu">–ù–∞–∑–≤–∞–Ω–∏–µ (ru)<span class="req-star">*</span></label>
            <input id="titleRu" type="text" />
          </div>
          <div class="admin-field" style="flex:1;">
            <label for="titleEs">–ù–∞–∑–≤–∞–Ω–∏–µ (es)<span class="req-star">*</span></label>
            <input id="titleEs" type="text" />
          </div>
        </div>

        <div class="admin-field">
          <label for="artist">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å<span class="req-star">*</span></label>
          <input id="artist" type="text" />
        </div>

        <div class="admin-row">
          <div class="admin-field" style="flex:1; min-width:220px;">
            <label for="level">–£—Ä–æ–≤–µ–Ω—å</label>
            <select id="level">
              <option value="">‚Äî</option>
              <option>A1</option><option>A2</option><option>B1</option><option>B2</option>
              <option>A2-B1</option><option>B1-B2</option>
            </select>
          </div>

          <div class="admin-field" style="flex:1; min-width:260px;">
            <label for="age">–í–æ–∑—Ä–∞—Å—Ç</label>
            <select id="age">
              <option value="all">all</option>
              <option value="12+">12+</option>
              <option value="16+" selected>16+</option>
              <option value="18+">18+</option>
            </select>
          </div>
        </div>

        <div class="admin-row">
          <div class="admin-field" style="flex:1;">
            <label for="otherLang">–ï—Å—Ç—å –¥—Ä—É–≥–æ–π —è–∑—ã–∫?</label>
            <select id="otherLang">
              <option value="false" selected>–Ω–µ—Ç</option>
              <option value="true">–¥–∞</option>
            </select>
          </div>

          <div class="admin-field" style="flex:1;">
            <label for="profanity">–ù–µ–Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–∞—è –ª–µ–∫—Å–∏–∫–∞</label>
            <select id="profanity">
              <option value="none" selected>none</option>
              <option value="mild">mild</option>
              <option value="explicit">explicit</option>
            </select>
          </div>
        </div>

        <div class="admin-field">
          <label for="restrNote">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –ø–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º</label>
          <input id="restrNote" type="text" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: –µ—Å—Ç—å —á–∞—Å—Ç–∏ –Ω–∞ —Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–æ–º" />
        </div>

        <div class="admin-field">
          <label>–ö—É–ª—å—Ç—É—Ä–∞ (—Ç–∏–ø—ã)</label>
          <div class="admin-chipset" id="cultureTags">
            <label><input type="checkbox" value="holidays"> –ø—Ä–∞–∑–¥–Ω–∏–∫–∏</label>
            <label><input type="checkbox" value="traditions"> —Ç—Ä–∞–¥–∏—Ü–∏–∏</label>
            <label><input type="checkbox" value="geography"> –≥–µ–æ–≥—Ä–∞—Ñ–∏—è</label>
            <label><input type="checkbox" value="cities"> –≥–æ—Ä–æ–¥–∞</label>
            <label><input type="checkbox" value="neighborhoods"> —Ä–∞–π–æ–Ω—ã</label>
            <label><input type="checkbox" value="food"> –µ–¥–∞</label>
            <label><input type="checkbox" value="music"> –º—É–∑—ã–∫–∞</label>
          </div>
        </div>

        <div class="admin-field">
          <label for="cultureItems">–ö—É–ª—å—Ç—É—Ä–∞ (–∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∞ ‚Äî –ø–æ —Å—Ç—Ä–æ–∫–µ)</label>
          <textarea id="cultureItems" placeholder="Malasa√±a&#10;La Habana&#10;D√≠a de Muertos"></textarea>
        </div>

        <div class="admin-row">
          <div class="admin-field" style="flex:1;">
            <label for="vocabulary">–õ–µ–∫—Å–∏–∫–∞ (–ø–æ —Å–ª–æ–≤—É –Ω–∞ —Å—Ç—Ä–æ–∫–µ)</label>
            <textarea id="vocabulary" placeholder="ritmo&#10;playa&#10;bailar"></textarea>
          </div>
          <div class="admin-field" style="flex:1;">
            <label for="grammar">–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞ (–∫–ª—é—á–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
            <input id="grammar" type="text" placeholder="presente, gustar, gerundio" />
          </div>
        </div>

        <div class="admin-field">
          <label for="pdfLink">PDF (—Å—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–∞–π–ª)</label>
          <input id="pdfLink" type="text" placeholder="./pdf/mi-lesson.pdf" />
          <div class="hint">–ü–æ–ª–æ–∂–∏ —Ñ–∞–π–ª –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, <b>pdf/</b>) –∏ –≤—Å—Ç–∞–≤—å –ø—É—Ç—å. –ù–∞ —Å–∞–π—Ç–µ –ø–æ—è–≤–∏—Ç—Å—è –∫–Ω–æ–ø–∫–∞ ¬´–°–∫–∞—á–∞—Ç—å PDF¬ª.</div>
        </div>

        <div class="admin-field">
          <label for="themes">–¢–µ–º—ã (–∫–ª—é—á–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
          <input id="themes" type="text" placeholder="love, party, travel" />
        </div>

        <div class="admin-field">
          <label for="lyrics">–¢–∞–π–º–∫–æ–¥—ã/—É—á–µ–±–Ω—ã–π —Ç–µ–∫—Å—Ç (time | text, –ø–æ —Å—Ç—Ä–æ–∫–µ)</label>
          <textarea id="lyrics" placeholder="0:00 | Intro&#10;0:12 | (—É—á–µ–±–Ω—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç/–ø–æ–¥—Å–∫–∞–∑–∫–∞)"></textarea>
        </div>

        <h3 style="margin-top:14px;">–ó–∞–¥–∞–Ω–∏—è <span class="pill" id="tasksCount">0</span></h3>
        <div class="tasks-toolbar">
          <button class="btn-light" id="btnAddTask" type="button">+ –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ</button>
          <span class="hint">–ë–µ–∑ JSON: –≤—Å—ë –≤ —Ñ–æ—Ä–º–µ.</span>
        </div>
        <div id="tasksContainer"></div>

        <div class="admin-actions">
          <button class="btn-primary" id="btnGenerate" type="button">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å JSON</button>
          <button class="btn-light" id="btnCopy" type="button">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
          <button class="btn-dark" id="btnDownload" type="button">–°–∫–∞—á–∞—Ç—å .json</button>
          <button class="btn-light" id="btnExportCsv" type="button">–≠–∫—Å–ø–æ—Ä—Ç CSV (3 —Ñ–∞–π–ª–∞)</button>

          <button class="btn-primary" id="btnAddToSet" type="button">–î–æ–±–∞–≤–∏—Ç—å –≤ –æ–±—â–∏–π –Ω–∞–±–æ—Ä</button>
          <button class="btn-light" id="btnExportSetJs" type="button">–≠–∫—Å–ø–æ—Ä—Ç songs-data.js</button>
          <button class="btn-light" id="btnExportSetJson" type="button">–≠–∫—Å–ø–æ—Ä—Ç songs.json</button>
          <button class="btn-light" id="btnExportSetCsv" type="button">–≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ–≥–æ –Ω–∞–±–æ—Ä–∞ (CSV)</button>

          <button class="btn-light" id="btnClear" type="button">–û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É</button>
                  <div class="admin-errors" id="adminErrors"></div>
        </div>

        <div class="admin-field" style="margin-top:12px;">
          <label>–û–±—â–∏–π –Ω–∞–±–æ—Ä <span class="pill" id="setCount">0</span></label>
          <div class="hint">–°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ (localStorage). –ï—Å–ª–∏ –æ—á–∏—Å—Ç–∏—Ç—å –∫—ç—à/–¥–∞–Ω–Ω—ã–µ —Å–∞–π—Ç–∞ ‚Äî –ø—Ä–æ–ø–∞–¥—ë—Ç.</div>
          <div id="setList"></div>
          <div class="admin-actions" style="margin-top:10px;">
            <button class="btn-light" id="btnClearSet" type="button">–û—á–∏—Å—Ç–∏—Ç—å –æ–±—â–∏–π –Ω–∞–±–æ—Ä</button>
          </div>
        </div>
      </div>

      <div class="admin-card">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
        <pre class="codebox" id="out">{}</pre>
        <div class="hint">
          –í—Å—Ç–∞–≤–ª—è–π –≤ <code>songs-data.js</code> –∫–∞–∫ –æ–±—ä–µ–∫—Ç –≤–Ω—É—Ç—Ä–∏ –º–∞—Å—Å–∏–≤–∞ <code>songsDataFromExternal</code>.
        </div>
      </div>
    </div>
  </div>

  <!-- –í–ê–ñ–ù–û: –ø–æ–¥–∫–ª—é—á–∞–µ–º —Ç–µ–∫—É—â–∏–π songs-data.js, —á—Ç–æ–±—ã —ç–∫—Å–ø–æ—Ä—Ç –î–û–ü–ò–°–´–í–ê–õ (append) –ø–µ—Å–Ω–∏, –∞ –Ω–µ –∑–∞—Ç–∏—Ä–∞–ª -->
  <script src="songs-data.js"></script>
  <script src="admin.js"></script>
</body>
</html>
